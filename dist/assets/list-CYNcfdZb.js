import{M as X}from"./modal-CVYFkxkt.js";import{h as Y,r,p as Z,s as $,o as ee,j as i,a as _,c as b,b as n,u as m,v as ae,w as o,F as M,q as P,n as I,l as y,E as te,P as le,D as ne,f as c,g as u,d as L,k as B,t as D}from"./index-B_p4t0Lo.js";import{P as oe}from"./PlusCircleOutlined-DkJMa-ih.js";const se={class:"list"},re={class:"fields w-full"},me={__name:"list",setup(ie){Y();let v=r([]),f=r(null),k=r([]),h=r([]),d=r("");const l=Z({name:"",main_cat_id:1,fields:[]});let p=r(!1),E=r({title:"Kategoriyani tanlang",width:"50%"});const O=[{title:"Main category",dataIndex:"category_name"},{title:"Category",dataIndex:"name"},{title:"Action",dataIndex:"action",customRender:({record:e})=>y("span",[y(te,{onClick:()=>R(e.id),style:{cursor:"pointer",marginRight:"15px"}}),y(le,{title:"Are you sure to delete this record?",onConfirm:()=>q(e.id),onCancel:()=>console.log("Delete canceled")},{default:()=>y(ne,{style:{cursor:"pointer"}})})])}],R=async e=>{f.value=e,p.value=!0,await S(e)},S=e=>{c.get("subcategory/one/"+e).then(a=>{l.name=a.data.data.name,l.main_cat_id=a.data.data.main_cat.id}).catch(a=>{u.error(a)})},q=e=>{c.delete("subcategory/delete/"+e).then(a=>{a.data&&g()})},N=()=>{p.value=!1,f.value==null?c.post("subcategory/create",l).then(async e=>{e.data.data&&(w(),await g())}).catch(e=>{u.warning(e)}):c.patch("subcategory/update/"+f.value,l).then(async e=>{f.value=null,w(),await g()}).catch(e=>{u.warning(e)})},w=()=>{l.name="",l.main_cat_id=1},U=e=>{console.log(e)},V=e=>{let a;for(let s of e)s!=null&&(a={sub_id:s});l.fields.push(a)},T=(e,a)=>{const s=h.value.find(C=>C.id==a.value);return s&&s.field_name.toLowerCase().includes(e.toLowerCase())},j=$(()=>d.value.length>0?v.value.filter(a=>a.name.toLowerCase().includes(d.value.toLowerCase())):v.value),z=()=>{p.value=!0,w()},K=()=>{p.value=!1},g=()=>{c.get("subcategory/all").then(e=>{u.success(`${e.data.message}`),v.value=e.data.data}).catch(e=>{u.warning(e)})},G=()=>{c.get("subcategory/admin_mainCategory").then(e=>{k.value=e.data.data}).catch(e=>{u.warning(e)})},H=()=>{c.get("fields/all").then(e=>{h.value=e.data.data}).catch(e=>{u.warning(e)})};return ee(()=>{g(),G(),H()}),(e,a)=>{const s=i("a-input"),C=i("a-table"),J=i("a-float-button"),F=i("a-select-option"),x=i("a-select"),A=i("a-form-item"),Q=i("a-form");return _(),b("div",se,[n(s,{class:"w-full my-2",value:m(d),"onUpdate:value":a[0]||(a[0]=t=>ae(d)?d.value=t:d=t),placeholder:"search field name"},null,8,["value"]),n(C,{columns:O,"data-source":j.value,pagination:{pageSize:50},scroll:{y:300}},null,8,["data-source"]),n(J,{type:"primary",onClick:z},{icon:o(()=>[n(m(oe))]),_:1}),n(X,{open:m(p),styles:m(E),onClose:K,onAdd:N},{category:o(()=>[n(Q,{model:l,name:"basic",autocomplete:"off",class:"w-full"},{default:o(()=>[n(A,{name:["dataForm.main_cat_id"],label:"Turkum",rules:[{required:!0,message:"Please input category_id!"}],"label-col":{span:24},"wrapper-col":{span:24},class:"w-8/12"},{default:o(()=>[n(x,{ref:"select",value:l.main_cat_id,"onUpdate:value":a[1]||(a[1]=t=>l.main_cat_id=t),onChange:U},{default:o(()=>[(_(!0),b(M,null,P(m(k),(t,W)=>(_(),L(F,{key:W,value:t.id},{default:o(()=>[B(D(t.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),n(A,{name:["name"],label:"iltimos, nom kiriting",rules:[{required:!0,message:"Please input name!"}],"label-col":{span:24},"wrapper-col":{span:24},class:"w-8/12"},{default:o(()=>[n(s,{value:l.name,"onUpdate:value":a[2]||(a[2]=t=>l.name=t),placeholder:"Masalan, Elektronika"},null,8,["value"])]),_:1}),I("div",re,[a[3]||(a[3]=I("h1",null,"Fields",-1)),n(x,{"show-search":"","filter-option":T,mode:"multiple",style:{width:"100%"},placeholder:"Please select",onChange:V},{default:o(()=>[(_(!0),b(M,null,P(m(h),t=>(_(),L(F,{key:t.id,value:t.id},{default:o(()=>[B(D(t.field_name),1)]),_:2},1032,["value"]))),128))]),_:1})])]),_:1},8,["model"])]),_:1},8,["open","styles"])])}}};export{me as default};
