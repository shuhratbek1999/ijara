import{M as X}from"./modal-aF0zQDtE.js";import{u as Y,r,y as Z,c as $,h as ee,p as i,o as _,a as b,b as k,j as n,k as m,z as ae,q as o,F as x,d as L,s as y,E as te,P as le,D as ne,m as c,g as u,l as B,e as D,t as E}from"./index-clLH2Q5S.js";import{P as oe}from"./PlusCircleOutlined-D152eYPa.js";const se={class:"list overflow-x-auto"},re={class:"fields w-full"},me={__name:"list",setup(ie){Y();let h=r([]),f=r(null),F=r([]),v=r([]),d=r("");const l=Z({name:"",main_cat_id:1,fields:[]});let p=r(!1),O=r({title:"Kategoriyani tanlang",width:"90%"});const A=[{title:"Main category",dataIndex:"category_name",width:100},{title:"Category",dataIndex:"name",width:100},{title:"Action",dataIndex:"action",width:100,customRender:({record:e})=>y("span",[y(te,{onClick:()=>R(e.id),style:{cursor:"pointer",marginRight:"15px"}}),y(le,{title:"Are you sure to delete this record?",onConfirm:()=>q(e.id),onCancel:()=>console.log("Delete canceled")},{default:()=>y(ne,{style:{cursor:"pointer"}})})])}],R=async e=>{f.value=e,p.value=!0,await S(e)},S=e=>{c.get("subcategory/one/"+e).then(a=>{l.name=a.data.data.name,l.main_cat_id=a.data.data.main_cat.id}).catch(a=>{u.error(a)})},q=e=>{c.delete("subcategory/delete/"+e).then(a=>{a.data&&g()})},N=()=>{p.value=!1,f.value==null?c.post("subcategory/create",l).then(async e=>{e.data.data&&(w(),await g())}).catch(e=>{u.warning(e)}):c.patch("subcategory/update/"+f.value,l).then(async e=>{f.value=null,w(),await g()}).catch(e=>{u.warning(e)})},w=()=>{l.name="",l.main_cat_id=1},U=e=>{console.log(e)},V=e=>{let a;for(let s of e)s!=null&&(a={sub_id:s});l.fields.push(a)},z=(e,a)=>{const s=v.value.find(C=>C.id==a.value);return s&&s.field_name.toLowerCase().includes(e.toLowerCase())},T=$(()=>d.value.length>0?h.value.filter(a=>a.name.toLowerCase().includes(d.value.toLowerCase())):h.value),j=()=>{p.value=!0,w()},K=()=>{p.value=!1},g=()=>{c.get("subcategory/all").then(e=>{u.success(`${e.data.message}`),h.value=e.data.data}).catch(e=>{u.warning(e)})},G=()=>{c.get("subcategory/admin_mainCategory").then(e=>{F.value=e.data.data}).catch(e=>{u.warning(e)})},H=()=>{c.get("fields/all").then(e=>{v.value=e.data.data}).catch(e=>{u.warning(e)})};return ee(()=>{g(),G(),H()}),(e,a)=>{const s=i("a-input"),C=i("a-table"),J=i("a-float-button"),M=i("a-select-option"),P=i("a-select"),I=i("a-form-item"),Q=i("a-form");return _(),b(x,null,[k("div",se,[n(s,{class:"w-full my-2",value:m(d),"onUpdate:value":a[0]||(a[0]=t=>ae(d)?d.value=t:d=t),placeholder:"search field name"},null,8,["value"]),n(C,{columns:A,"data-source":T.value,pagination:{pageSize:50},scroll:{x:A.length*150,y:400}},null,8,["data-source","scroll"]),n(J,{type:"primary",onClick:j},{icon:o(()=>[n(m(oe))]),_:1})]),n(X,{open:m(p),styles:m(O),onClose:K,onAdd:N},{category:o(()=>[n(Q,{model:l,name:"basic",autocomplete:"off",class:"w-full"},{default:o(()=>[n(I,{name:["dataForm.main_cat_id"],label:"Turkum",rules:[{required:!0,message:"Please input category_id!"}],"label-col":{span:24},"wrapper-col":{span:24},class:"w-8/12"},{default:o(()=>[n(P,{ref:"select",value:l.main_cat_id,"onUpdate:value":a[1]||(a[1]=t=>l.main_cat_id=t),onChange:U},{default:o(()=>[(_(!0),b(x,null,L(m(F),(t,W)=>(_(),B(M,{key:W,value:t.id},{default:o(()=>[D(E(t.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),n(I,{name:["name"],label:"iltimos, nom kiriting",rules:[{required:!0,message:"Please input name!"}],"label-col":{span:24},"wrapper-col":{span:24},class:"w-8/12"},{default:o(()=>[n(s,{value:l.name,"onUpdate:value":a[2]||(a[2]=t=>l.name=t),placeholder:"Masalan, Elektronika"},null,8,["value"])]),_:1}),k("div",re,[a[3]||(a[3]=k("h1",null,"Fields",-1)),n(P,{"show-search":"","filter-option":z,mode:"multiple",style:{width:"100%"},placeholder:"Please select",onChange:V},{default:o(()=>[(_(!0),b(x,null,L(m(v),t=>(_(),B(M,{key:t.id,value:t.id},{default:o(()=>[D(E(t.field_name),1)]),_:2},1032,["value"]))),128))]),_:1})])]),_:1},8,["model"])]),_:1},8,["open","styles"])],64)}}};export{me as default};
